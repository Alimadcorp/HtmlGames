<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Signup Page</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Geist", "ui-sans", "system-ui"],
            mono: ["GeistMono", "ui-monospace", "monospace"],
            bold: ["Geist", "ui-sans-serif", "system-ui"],
            title: ["GeistMono", "ui-monospace", "monospace"],
          },
          fontWeight: {
            sans: 'normal',
            mono: 'normal',
            bold: 'bold',
            title: 'bold',
          },
          colors: {
            theme: "#2563eb"
          },
        },
      },
    };
  </script>
  <style type="text/tailwindcss">
    @layer base {
      body {
        user-select: none;
        overflow-x: hidden;
        -webkit-tap-highlight-color: transparent;
      }
      .emoji img {
        @apply inline-block align-middle;
        height: 1.5em;
        width: auto;
        transform-origin: center;
      }
      .anchor {
        @apply text-blue-400 hover:underline cursor-pointer inline
      }
      button, input {
        @apply transition-all duration-300 ease-in-out;
      }
      button:disabled {
        opacity: .5;
        color: #6b7280;
        background-color: #38393b;
        cursor: not-allowed;
      }
      input:disabled {
        opacity: .5;
        background: #38393b;
        color: #9da8bd;
        border: 2px solid #9da8bd;
        cursor: not-allowed;
      }
      .slider {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 10px;
        border: 1px solid #777;
        margin-top: 3px;
        border-radius: 5px;
        background: #f0f0f0;
        outline: none;
      }
      .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        background: #777777;
        border: 3px solid white;
        border-radius: 50%;
        cursor: pointer;
      }
      .toast {
        opacity: 0;
        border: 0.15em solid #fff4;
        border-radius: 0.5em;
        backdrop-filter: blur(5px) brightness(1.5);
        transform: translateY(20px) scale(.95);
        transition: .25s ease;
      }
      .toast.show {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      .toast.hide {
        opacity: 0;
        transform: translateY(10px) scale(.9);
      }
      .toast-close {
        position: absolute;
        top: -6px;
        right: -6px;
        width: 18px;
        height: 18px;
        border-radius: 999px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #0005;
        backdrop-filter: blur(4px);
        cursor: pointer;
      }
    }
  </style>
  <style>
    @font-face {
      font-family: "Geist";
      src: url("https://proxy.alimad.co/api/proxy?url=https://cdn.alimad.co/f/geist.woff2") format("woff2");
      font-weight: normal, bold;
      font-style: normal;
    }
    @font-face {
      font-family: "GeistMono";
      src: url("https://proxy.alimad.co/api/proxy?url=https://cdn.alimad.co/f/GeistMono.woff2") format("woff2");
      font-weight: normal, bold;
      font-style: normal;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-[#002033] to-black flex items-center justify-center min-h-screen font-sans">
  <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-6 sm:p-8 w-full max-w-md mx-4 sm:mx-auto shadow-lg flex flex-col gap-6 my-10">
    <h1 class="flex flex-wrap-nowrap items-center justify-center text-white font-title whitespace-nowrap text-[clamp(1rem,3vw,2rem)] md:text-[1.3rem]">
      <span id="titl" class="flex-shrink-0">Sign Up for&nbsp;</span>
      <span class="flex-shrink-0">TheCloudServices™</span>
    </h1>
    <hr class="opacity-30">
    <form class="flex flex-col gap-4" id="form1" style='display:flex'>
      <p class="text-gray-500 text-sm text-center">Enter email address</p>
      <input required type="email" placeholder="Email" id="email" 
        class="transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base" />
      <input type="password" placeholder="Password" id='password' style="display:none"
        class="transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base" />
      <button id="create1" type="submit" disabled
        class="bg-blue-600 hover:brightness-120 text-white font-bold py-3 rounded-lg transition-all flex items-center justify-center text-sm sm:text-base">
        Create Account
      </button>
    </form>
    <form class="flex flex-col gap-4" id="form3" style='display:none'>
      <p class="text-gray-500 text-sm text-center">Step 2: Enter your name</p>
      <input id="name1" placeholder="First name" required data-key="first"
      class="transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name2" placeholder="Middle name" required data-key="middle"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name3" placeholder="Second middle name" required data-key="second-middle"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name4" placeholder="Nickname" required data-key="nick"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name5" placeholder="Preferred name" required data-key="preferred"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name6" placeholder="Maiden name" required data-key="maiden"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name7" placeholder="Birth name" required data-key="birth"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name8" placeholder="Honorific title" required data-key="title"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name9" placeholder="Suffix" required data-key="suffix"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name10" placeholder="Pen name" required data-key="pen"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name11" placeholder="Name of favourite personality" required data-key="personality"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name12" placeholder="Name of your father's father" required data-key="grandfather"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name13" placeholder="Name of the guy who lives next door" required data-key="neighbour"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <input id="name14" placeholder="Last name" required data-key="last"
      class="hidden transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
      <button id="create3" type="submit" disabled
        class="bg-blue-600 hover:brightness-120 text-white font-bold py-3 rounded-lg transition-all flex items-center justify-center text-sm sm:text-base">
        Next
      </button>
    </form>
    <form class="flex flex-col gap-4" id="form2" style='display:none'>
      <p class="text-gray-500 text-sm text-center">Step 3: Select a username</p>
      <input id="username" placeholder="Username" required disabled
        class="transition-all p-3 rounded-lg bg-white/10 placeholder-white text-white focus:ring-2 focus:ring-blue-500 outline-none text-sm sm:text-base h-12 disabled:text-white disabled:opacity-100">
        <div class="flex items-center gap-0 justify-center text-white">
          <div id="rot1" class="px-2 text-3xl font-title cursor-pointer hover:bg-[#ffffff22] rounded-md">a</div>
          <div id="rot2" class="px-2 text-3xl font-title cursor-pointer hover:bg-[#ffffff22] rounded-md">j</div>
          <div id="rot3" class="px-2 text-3xl font-title cursor-pointer hover:bg-[#ffffff22] rounded-md">s</div>
          <div id="rot4" class="px-2 text-3xl font-title cursor-pointer hover:bg-[#ffffff22] rounded-md">1</div>
          <div id="back" class="mx-2 px-3 py-1.5 bg-red-500/10 rounded-lg active:scale-95 hover:bg-red-500 transition cursor-pointer">←</div>
        </div>
      <button id="create2" type="submit" disabled
        class="bg-blue-600 hover:brightness-120 text-white font-bold py-3 rounded-lg transition-all flex items-center justify-center text-sm sm:text-base">
        Next
      </button>
    </form>
    <form class="flex flex-col gap-4" id="form4" style='display:none'>
      <p class="text-gray-400 text-sm text-center">Step 4: Please select your gender</p>
      <div class="flex flex-col gap-1">
        <label for="gender1" class="text-white text-sm">Man</label>
        <input id="gender1" type="range" min="0" max="100" value="0" oninput="slid(this)" required class="slider">
      </div>
      <div class="flex flex-col gap-1">
        <label for="gender2" class="text-white text-sm">Woman</label>
        <input id="gender2" type="range" min="0" max="100" value="0" oninput="slid(this)" required class="slider">
      </div>
      <div class="flex flex-col gap-1">
        <label for="gender3" class="text-white text-sm">Crossiant</label>
        <input id="gender3" type="range" min="0" max="100" value="0" oninput="slid(this)" required class="slider">
      </div>
      <div class="flex flex-col gap-1">
        <label for="gender4" class="text-white text-sm">French</label>
        <input id="gender4" type="range" min="0" max="100" value="0" oninput="slid(this)" required class="slider">
      </div>
      <div class="flex flex-col gap-1">
        <label for="gender5" class="text-white text-sm">Human</label>
        <input id="gender5" type="range" min="0" max="100" value="0" oninput="slid(this)" required class="slider">
      </div>
      <div class="flex flex-col gap-1">
        <label for="gender6" class="text-white text-sm">Clanker</label>
        <input id="gender6" type="range" min="0" max="100" value="0" oninput="slid(this)" required class="slider">
      </div>
      <div id="notification4" class="text-center font-sans mt-0 px-2 py-1 bg-gray-900/10 rounded-md text-red-500"></div>
      <button id="create4" type="submit" disabled
        class="bg-blue-600 hover:brightness-110 text-white font-bold py-3 rounded-lg transition-all flex items-center justify-center text-sm sm:text-base">
        Next
      </button>
    </form>
    <form class="flex flex-col gap-4" id="form5" style="display:none">
      <p class="text-gray-400 text-sm text-center">Step 5: Enter date of birth</p>
      <div class="flex gap-2 justify-center text-black">
        <div class="flex flex-col items-center">
          <span id="day" class="w-12 text-center text-lg text-white">01</span>
        </div>
        <div class="flex flex-col items-center">
          <span class="text-center text-lg text-white">-</span>
        </div>
        <div class="flex flex-col items-center">
          <span id="month" class="w-12 text-center text-lg text-white">01</span>
        </div>
        <div class="flex flex-col items-center">
          <span class="text-center text-lg text-white">-</span>
        </div>
        <div class="flex flex-col items-center">
          <span id="year" class="w-16 text-center text-lg text-white">1900</span>
        </div>
      </div>
      <input type="range" min="0" max="47481" oninput="slid(this,47481)" value="0" id="dateSlider"
        class="w-full h-2 rounded-full bg-gray-300 slider mt-4">
      <div id="notification5" class="text-center font-semibold mt-0 text-red-500 px-2 py-1 bg-gray-900/10 rounded-md"></div>
      <button id="create5" type="submit" disabled
        class="bg-blue-600 hover:brightness-110 text-white font-bold py-3 rounded-lg transition-all flex items-center justify-center text-sm sm:text-base">
        Next
      </button>
    </form>
    <form class="flex flex-col gap-4 font-sans text-white" id="form6" style="display:none">
      <p class="text-gray-400 text-sm text-center">Step 6: Select your region</p>
      <div id="display" class="text-2xl font-sans bg-white/10 backdrop-blur p-6 rounded-xl min-w-[200px] text-center">
        ---
      </div>
      <button id="roller" type="button" class="bg-blue-600 px-6 py-3 rounded-xl text-lg active:scale-95 transition">
        Roll
      </button>
      <input type="hidden" name="region" id="regionInput" required>
      <button id="create6" type="submit" disabled
        class="bg-blue-600 hover:brightness-110 text-white font-bold py-3 rounded-lg transition-all flex items-center justify-center text-sm sm:text-base">
        Next
      </button>
    </form>
    <p id="login" class="text-white/70 text-center text-xs sm:text-sm">
      Already have an account? 
      <span onclick="login()" class="text-blue-400 hover:underline anchor">Log in</span>
    </p>
  </div>
  <div id="toasts" class="fixed bottom-4 right-4 flex flex-col gap-2 z-50"></div>
  <script src="https://cdn.jsdelivr.net/npm/lucide@0.553.0/dist/umd/lucide.min.js"></script>
  <script>

    // ----------------------- UTILITY -----------------------

    const a = e => requestAnimationFrame(e);
    const g = (e) => document.getElementById(e);
    const l = lucide.createIcons;
    const q = (e) => document.querySelectorAll(e);
    const ud = () => { g("day").textContent = state.day.toString().padStart(2, "0"); g("month").textContent = state.month.toString().padStart(2, "0"); g("year").textContent = state.year; g("dateSlider").value = d2s(state.day, state.month, state.year); slid(g("dateSlider"),47481); const allowed = allo(state.year); g('create5').disabled = !allowed; };
    const d2s = (d, m, y) => Math.floor((new Date(y,m-1,d) - new Date(1900,0,1)) / (1000*60*60*24));
    const del = (k) => localStorage.removeItem(k);
    const ord = (n) => { const s = ["th","st","nd","rd"], v = n % 100; return n + (s[(v-20)%10] || s[v] || s[0]) };
    const pre = (e, t) => t.map(str => e + str);
    const reg = () => g("display").textContent = state.region = g('regionInput').value = state.regions[Math.floor(Math.random() * state.regions.length)];
    const s2d = (value) => {const start = new Date(1900,0,1); const date = new Date(start.getTime() + value*24*60*60*1000); state.day = date.getDate(); state.month = date.getMonth()+1; state.year = date.getFullYear(); ud()};
    const allo = (t) => {let e="",l=!0;for(let n in agesAllowed){let[o,i]=n.split("-").map(Number);if(t>=o&&t<=i){l=agesAllowed[n].allowed,e=agesAllowed[n].note;break}}let s=g("notification5");return s.textContent=e||"",s.classList.toggle("text-green-500",l),s.classList.toggle("text-red-500",!l),l};
    const exec = (f, t) => setTimeout(f, t);
    const fetc = async (x,o) => {let r,t,b,e;x=typeof x=="string"?[x]:x;for(let u of x){try{r=await fetch(u,o);if(!r.ok)throw r;t=await r.text();try{b=JSON.parse(t)}catch{b=t}return b}catch(er){e=er}}return e};
    const list = (i) => g('form'+i).addEventListener("input", e => {g('create'+i).disabled = !g('form'+i).checkValidity()});
    const load = (k, d = 0) => { let w = localStorage.getItem(k); if(!w) return d; try { return JSON.parse(w) } catch { return /^\d+$/.test(w) ? parseInt(w):w }};
    const rick = () => window.open("https://cdn.alimad.co/f/static/Ricky.mp4", '_self');
    const save = (k, e) => localStorage.setItem(k, typeof e == 'string' ? e : JSON.stringify(e));
    const shuf = (s) => [...s].sort(()=>Math.random()-0.5).join('');
    const slid = (sl, m = 100) => { const v=sl.value/m*100; sl.style.background = `linear-gradient(to right, #1b5bba 0%, #1b5bba ${v}%, #eaeaea ${v}%, #eaeaea 100%)`}
    const titl = s => s.replace(/\w\S*/g, w => w[0].toUpperCase() + w.slice(1).toLowerCase());
    
    // ----------------------- GLOBAL VARIABLES -----------------------

    let state = { create1att: 0, day: 1, month: 1, year: 1900, regions: [], region: "", ri: null };
    const chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789()-_.';
    const agesAllowed = {
      "1900-1910":  { allowed: false, note: "Whoa, ancient scroll in the library" },
      "1911-1920":  { allowed: false, note: "nope" },
      "1921-1930":  { allowed: false, note: "not allowed" },
      "1931-1940":  { allowed: false, note: "Old enough to tell stories nobody believes" },
      "1941-1950":  { allowed: false, note: "Nah" },
      "1951-1960":  { allowed: false, note: "Still too old bruv" },
      "1961-1970":  { allowed: true, note: "Hi there good sirr" },
      "1971-1990":  { allowed: true,  note: "Another potential slave- I mean, by all means, welcome!" },
      "1991-2000":  { allowed: true,  note: "Brain fully developed!" },
      "2001-2001":  { allowed: false,  note: "9/11?" },
      "2002-2010":  { allowed: true,  note: "Welcome to the Club" },
      "2011-2015":  { allowed: true,  note: "Might break a thing or two but welcome" },
      "2016-2020":  { allowed: false, note: "Too young — go watch soem tiktok or smth" },
      "2021-2030":  { allowed: false, note: "Bots and toddlers not allowed" },
    }

    // ----------------------- INITIAL LOGIC -----------------------

    const seqs = { rot1: "abcdefghi", rot2: "jklmnopqr", rot3: "stuvwxyz_", rot4: "1234567890"};
    for (let id in seqs) {
      state[id] = 0;
      setInterval(() => {
        let s = seqs[id];
        state[id] = (state[id] + 1) % s.length;
        document.getElementById(id).textContent = s[state[id]];
      }, 400);
    }
    for (let id in seqs) {
      document.getElementById(id).onclick = () => {
        g('username').value += document.getElementById(id).textContent;
        g('create2').disabled = g('username').value.length < 4;
      };
    }
    back.onclick = () => { let u = g('username'); u.value = u.value.slice(0, -1); g('create2').disabled = g('username').value.length < 4; };

    for(let i = 1; i <= 13; i++){
      g('name'+i).addEventListener('input', e => g('name'+(i+1)).style.display = (g('name'+i).value.length > 2) ? 'inline' : 'none');
    }

    function login() { // On click 'Log in instead'
      let i = g('login').innerHTML; save('lih', i);
      let att = load('login.attempts'); let lo = load('login.loop');
      let o, xs, d = 2000;
      switch(att){
        case 0: o = "Bro you don't have an account yet"; break
        case 1: o = "I said bro you don't even have an account yet"; break
        case 2: o = "Look, you need to sign up first, before trying to login"; break
        case 3: o = "Do you even remember your username?"; break
        case 4: o = "Are you sure?"; break
        case 5: o = "Stop lying, I can see all accounts"; break
        case 6: o = "Oh god please just follow the steps above"; break
        case 7: o = "What are you on in for <span class='emoji'>:heavysob:</span>"; break
        case 8: o = "SIGN UP BEFORE TRYING TO LOG IN"; break
        case 9: o = "<p class='font-bold'>YOU HAVE NO ACCOUNT TO LOG IN TO YET</p>"; break
        case 10: o = "<p class='gibberish font-bold'>123456789012345678901234567890</p>"; break
        case 11: o = "<span class='emoji'>:noooovanish:</span> ".repeat(10); break
        case 12: o = "<span class='emoji'>:heavysob-random:</span> ".repeat(15); if(lo > 0) o = `Bro this is your ${titl(ord(lo+1))} time doing this <span class='emoji'>:heavysob:</span>`; break
        case 13: o = "Fine, you won"; xs = "Here you go: "; save('login.loop', lo + 1); break
        case 14: o = "Bro has memory loss"; break;
        case 15: o = "BRO WHAT THE HELL DO YOU WANNA GO AGAIN"; break
        case 16: o = "Fine"; break
        default: o = "<span class='emoji'>:heavysob:</span>"; att = -1; break
      }
      g('login').innerHTML = o;
      emojify();
      save('login.attempts', att + 1);
      if(!xs) exec(() => g('login').innerHTML = i, d);
      else exec(() => { g('login').innerHTML = xs; exec(() => { g('create1').textContent = "Log In"; g('login').innerHTML = "Don't have an account? <span class='anchor' onclick=\"this.style.display = 'none'\">Sign up</span>"; g('password').style.display = 'inline'; g('password').required = true; g('titl').innerHTML = "Log In to&nbsp;"; save('login.attempts', 999) }, d) }, d);
    }
    function signup() {
      const el = g('create1');
      const orig = el.dataset.orig ?? (el.dataset.orig = el.innerHTML);
      const d = 2000;
      state.create1att = state.create1att || 0;
      if (state.create1att === 0) {
        el.innerHTML = 'Are you sure?';
        state.create1att = 1;
        clearTimeout(state._create1Revert);
        state._create1Revert = exec(() => { el.innerHTML = orig; state.create1att = 0; state._create1Revert = null; }, d);
        return;
      }
      if (state.create1att === 1) {
        state.create1att = 2;
        clearTimeout(state._create1Revert);
        el.setAttribute('disabled', '');
        el.style.pointerEvents = 'none';
        el.innerHTML = 'Loading...<div style="margin-top:8px;height:6px;background:#222;border-radius:6px;overflow:hidden"><div class="__fill" style="width:0%;height:100%"></div></div>';
        clearInterval(state._create1Timer);
        let p = 0;
        state._create1Timer = setInterval(() => {
          p = Math.min(100, p + (Math.random() * 12 + 6));
          const fill = el.querySelector('.__fill');
          if (fill) fill.style.width = p + '%';
          if (p >= 100) {
            clearInterval(state._create1Timer);
            state._create1Timer = null;
            el.innerHTML = '<i data-lucide="loader" class="w-6 h-6 text-white animate-spin" aria-hidden="true"></i>'; l();
            exec(() => { el.removeAttribute('disabled'); el.style.pointerEvents = ''; el.innerHTML = orig; state.create1att = 0; g('form1').style.display = 'none'; g('form3').style.display = 'flex'; g('login').remove(); step('email', g('email').value); }, 600);
          }
        }, 200);
        return;
      }
    }

    async function next(){ // On click submit
      if( load('login.attempts') == 999 ){
        g('email').disabled = g('password').disabled = g('create1').disabled = true;
        g('create1').innerHTML = '<i data-lucide="loader" class="w-6 h-6 text-white animate-spin" aria-hidden="true"></i>'; l();
        let d = `?email=${g('email').value}&pwd=${g('password').value}`;
        let r = await fetc(['/auth/login'+d,'/auth/login.html'+d]);
        exec(() => { alert(r); g('create1').textContent = "Create Account"; g('login').innerHTML = "See? I told you, you have no account yet"; g('password').style.display = 'none'; g('password').required = false; g('titl').innerHTML = "Sign Up for&nbsp;"; g('email').disabled = g('password').disabled = g('create1').disabled = false; save('login.attempts', 14); exec(() => g('login').innerHTML = load('lih'), 3000) }, Math.random() * 1000);
      } else {
        signup();
      }
    }

    function step(key, input){
      let data = { email: "", name: {}, username: "", gender: {}, age: "" };
      data = load("signup.data", data);
      data[key] = input;
      save("signup.data", data);
      save("signup.initiated", 1);
    }

    function ongender(e){
      let x = 'gender'; let reasons = [];
      let [man, woman, crossiant, french, human, clanker] = [ g('gender1').value, g('gender2').value, g('gender3').value, g('gender4').value, g('gender5').value, g('gender6').value ];
      if(man + woman < 30 && human < 30) reasons.push("Man/Woman ratio too low");
      if(crossiant + french < 30) reasons.push("Your Croissant-to-French ratio is illegal in Paris");
      if((human < 10 || clanker > 90) || clanker > human) reasons.push("Clankers not allowed");
      if(clanker + human < 30) reasons.push("Must be at least somewhat human");
      if(french > 70) reasons.push("Too French, not allowed");
      g("notification4").textContent = reasons[0];
      g('notification4').style.display = reasons.length > 0 ? 'inline' : 'none';
      g('create4').disabled = reasons.length > 0;
    }

    const complete = () => save("signup.initiated", 0);

    // ----------------------- EVENT LISTENERS -----------------------

    [1, 2, 3, 6].forEach(e => list(e));

    // Email Form
    g('form1').addEventListener("submit", e => {
      e.preventDefault();
      if (!g('form1').checkValidity()) return;
      next();
    })
    // Name Form
    g('form3').addEventListener('submit', e => {
      e.preventDefault();
      if (!g('form3').checkValidity()) return;
      let d = {};
      for(let i = 1; i <= 14; i++){
        d[g('name'+i).getAttribute('data-key')] = g('name'+i).value;
      }
      step('name', d);
      g('form2').style.display = 'flex';
      g('form3').style.display = 'none';
    });
    // Username Form
    g('form2').addEventListener('submit', e => {
      e.preventDefault();
      if (!g('form2').checkValidity()) return;
      step('username', g('username').value);
      g('form2').style.display = 'none';
      g('form4').style.display = 'flex';
    });
    // The Gender Selector
    g('form4').addEventListener('submit', e => {
      e.preventDefault();
      if (!g('form4').checkValidity()) return;
      step('gender', { man: g('gender1').value, woman: g('gender2').value, crossiant: g('gender3').value, french: g('gender4').value, human: g('gender5').value, clanker: g('gender6').value });
      g('form5').style.display = 'flex';
      g('form4').style.display = 'none';
    });
    for(let i = 1; i <= 6; i++){ g('gender'+i).addEventListener('change', e => ongender(e.target.value)) }
    // Date of Birth
    g('form5').addEventListener('submit', e => {
      e.preventDefault();
      if (!g('form5').checkValidity()) return;
      step('age', `${state.day}-${state.month}-${state.year}` );
      g('form6').style.display = 'flex';
      g('form5').style.display = 'none';
    });
    g("dateSlider").addEventListener("input", () => s2d(g("dateSlider").value));
    // Select Region
    g('form6').addEventListener('submit', e => {
      e.preventDefault();
      if (!g('form6').checkValidity()) return;
      step('region', state.region );
      //g('form5').style.display = 'flex';
      //g('form6').style.display = 'none';
      g('form6').innerHTML = "<p class='align-center text-white text-xl'>That's it for now</p>";
      complete();
      notify("Come back later for the whole experience");
    });
    ((e = g('roller')) => {
      e.t = e.addEventListener;
      e.t("mousedown", () => { state.ri = setInterval(reg, 20); })
      e.t("mouseup", () => { clearInterval(state.ri); state.ri = null; })
      e.onclick = () => {reg(); g('create6').disabled = false;}; 
    })();

    // ----------------------- SATURATORS & EXTRA -----------------------

    const notify = (text, type="info") => {
      const icons = {
        info: "info",
        error: "alert-circle",
        success: "circle-check"
      };
      const colors = {
        info: "blue-600",
        error: "red-600",
        success: "green-600"
      };
      const box = document.createElement("div");
      box.className = `toast relative min-w-[220px] px-2 py-1 bg-${colors[type]}/10 shadow-lg flex ml-4 items-center gap-2 text-${colors[type]}`;
      box.innerHTML = `
        <i data-lucide="${icons[type]}" class="w-4 h-4"></i>
        <span class="flex-1 text-[1em] text-white">${text}</span>
        <div class="toast-close text-white border border-white/10"><i data-lucide="x" class="w-3 h-3"></i></div>
      `;
      const container = document.getElementById("toasts");
      container.appendChild(box); l(); emojify();
      a(() => box.classList.add("show"));
      const closeBtn = box.querySelector(".toast-close");
      closeBtn.onclick = e => {
        e.stopPropagation();
        box.classList.remove("show");
        box.classList.add("hide");
        setTimeout(() => box.remove(), 250);
      };
    }
    const loadRegions = async () => {
      const data = await fetc("https://restcountries.com/v3.1/all?fields=name");
      state.regions = [...data.map(c => c.name.common).filter(Boolean).filter((r, i, arr) => arr.indexOf(r)===i).sort(), "Untitled States of America", "The Great Brutain", "Pakishtan", "Italiano ma beloved", "Ohayo Gozaimasu"];
    };
    const gibberish = () => {
      const gen = l => Array.from({length: l}, () => chars[Math.floor(Math.random()*chars.length)]).join('');
      q(".gibberish").forEach(el => {
        el.textContent = gen(el.textContent.length);
      });
      a(gibberish);
    };
    const emojify = () => {
      let e = q(".emoji:not([data-emojified])").forEach(el => {
        el.dataset.emojified = "true";
        let u = el.textContent.replaceAll(':', '');
        el.innerHTML = `<img src='https://e.alimad.co/${u.trim()}'>`;
      })
    };
    const preload = (urls) => {
      urls.forEach(url => {
        const img = new Image();
        img.src = url;
      });
    };
    preload([
      ...pre('https://e.alimad.co/', ['heavysob', 'heavysob-random', 'noooovanish', 'evilgrin'])
    ]);
    window.onload = () => { l(); del('login.attempts'); setInterval(emojify, 500); gibberish(); if(load("signup.initiated", false)) notify("Looks like you refreshed and lost all your form data. No, I'm not gonna recover it because evil <span class='emoji'>:evilgrin:</span>", 'error'); loadRegions(); };
  </script>
</body>
</html>
